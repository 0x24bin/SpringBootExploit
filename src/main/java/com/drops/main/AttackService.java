package com.drops.main;

import com.drops.entity.ControllersFactory;
import com.drops.exp.SnakeYAMLRCEEXP;
import com.drops.poc.SnakeYAMLRCEPOC;
import com.drops.poc.SpringBootInfo;
import com.drops.poc.SpringBootInfoCheck;
import com.drops.ui.MainController;
import com.drops.utils.Utils;

import java.util.ArrayList;
import java.util.List;

/**
 * @ClassName: AttackService
 * @Description: TODO
 * @Author: Summer
 * @Date: 2021/8/2 15:38
 * @Version: v1.0.0
 * @Description:
 **/
public class AttackService {
    String target ;
    String time;
    MainController mainController ;
    SpringBootInfoCheck infoCheck;
    SpringBootInfo info = new SpringBootInfo();


    public AttackService(String targetAddressText, String httpTimeoutText) {
        this.mainController = (MainController) ControllersFactory.controllers.get(MainController.class.getSimpleName());
        this.time = httpTimeoutText;
        this.target = targetAddressText;
        this.infoCheck = new SpringBootInfoCheck();
    }

    public boolean gadgetSend(String target, String vps, String gadget, String echo){
        boolean flag = infoCheck.isSpringbootVersionV1();
        String env = "/env";
        String env2 = "/actuator/env";
        System.out.println(target);
        System.out.println(vps);
        System.out.println(gadget);
        System.out.println(echo);

        try {
            if (flag){
                if (gadget.equalsIgnoreCase("SnakeYAMLRCE")) {
                    SnakeYAMLRCEEXP exp = new SnakeYAMLRCEEXP();
                    return exp.sendExp(target,vps,echo,flag);
                }else if (gadget.equalsIgnoreCase("EurekaXstreamRCE")){

                }

            }
        }catch (Exception e){
            this.mainController.logTextArea.appendText(Utils.log(e.getMessage()));
        }

        return false;
    }


    public void setPOCRequest(String target, String vps, String gadget,String echo){

    }

}
